<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

<link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¥¥&lt;/text&gt;&lt;/svg&gt;">


<style>
  :root {
    font-size: 20px;
}
</style>
  <title>
    é…ç½® cargo workspace&nbsp;|&nbsp;413â€™s Website
  </title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="é…ç½® cargo workspace">
  
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
      <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¥¥&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="Note.html">
    <div class="Navbar__Btn">
      
      <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¶&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Note</span>
    </div>
  </a>
  
  
  
  
  
  
  
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="reference.html">
    <div class="Navbar__Btn">
      
      <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ“–&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>æ‚é¡¹</span>
    </div>
  </a>
  
  
  
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="About.html">
    <div class="Navbar__Btn">
      
      <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ˜€&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>About</span>
    </div>
  </a>
  
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
    <h1 class="Header__Title">
      é…ç½® cargo workspace
    </h1>
    
    <div class="DateTagBar">
      
      <span class="DateTagBar__Item DateTagBar__Date">Posted on Mon, Sep 2, 2024</span>
      
      
      <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--purple">
        <a href="tag/Rust.html">
          Rust
        </a>
      </span>
      
      <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--red">
        <a href="tag/å•ç‰‡æœº.html">
          å•ç‰‡æœº
        </a>
      </span>
      
    </div>
    
  </header>
  <article id="https://www.notion.so/aa7a4860f931439aa1defeaff51e1301" class="PageRoot"><div id="https://www.notion.so/b4bc43cfd16e40b18ab58a6e8f576638" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">åœ¨ ~/code/esp32 ä¸‹åˆ›å»º std/non_std ä¸¤ä¸ªç›®å½•ï¼Œåˆ†åˆ«ä½œä¸º std å’Œ non_std åº”ç”¨çš„ workspace ç›®å½•ï¼Œ ä¹‹æ‰€ä»¥åŒºåˆ†ä»–ä»¬æ˜¯å› ä¸º workspace ç›®å½•ä¸‹çš„ .cargo/config.toml æ–‡ä»¶é…ç½®ä¸åŒï¼š</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/73ca1d75cf7c4cc4868e5f47f3255aaf" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">std workspaceï¼šåˆ›å»º Cargo.tomlï¼Œä»ä¸€ä¸ª std åº”ç”¨ç›®å½•æ‹·è´.cargo/config.toml/rust-toolchain.toml/sdkconfig.defaults æ–‡ä»¶ï¼›</mark></span></span></li><li id="https://www.notion.so/d3523f3980e84554a8603b47df043d95" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">non_std workspace: åˆ›å»º Cargo.tomlï¼Œä»ä¸€ä¸ª non_std åº”ç”¨ç›®å½•æ‹·è´.cargo/config.toml/rust-toolchain.toml/sdkconfig.defaults æ–‡ä»¶ï¼›</mark></span></span></li></ol><div id="https://www.notion.so/546fb1ae22c648e0b295a2c243b7b4ab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">std workspaceï¼š</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/833646d59b4548ec8e9c24c8fc76c4dc" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">.cargo/config.toml ä¸­è®¾ç½®æœ€æ–°çš„ ESP_IDF_VERSION = â€œv5.2.1â€ï¼Œæ²¡æœ‰æŒ‡å®š ESP_IDF_TOOLS_INSTALL_DIR = â€œglobalâ€ï¼Œè¿™æ ·ä¼šåœ¨ workspace ç›®å½•ä¸‹çš„ .embuild ä¸­ä¿å­˜ä¸€ä»½ã€‚</mark></span></span></li></ol><div id="https://www.notion.so/5d16efbb467e4e0cb164fb8cf9bd7044" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">Copy</mark></span></span></p></div><pre id="https://www.notion.so/ed9fc4a80c864f9396f7107c270500a3" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>zj@a:~/code/esp32/std$ cat Cargo.toml
[workspace]
resolver = &quot;2&quot; # æ²¡æœ‰æŒ‡å®š workspace çš„ root package æ—¶å¿…é¡»è¦æŒ‡å®šè¯¥å‚æ•°
members = [  # std åº”ç”¨ç›®å½•åˆ—è¡¨
  &quot;myesp&quot;,
  &quot;myespv2&quot;,
  &quot;myespv3&quot;,
]

exclude = [ # æ’é™¤çš„ç›®å½•åˆ—è¡¨
  &quot;mycmake&quot;,
  &quot;old&quot;,
]

[profile.release]
opt-level = &quot;s&quot;

[profile.dev]
debug = true    # Symbols are nice and they don&#x27;t increase the size on Flash
opt-level = &quot;z&quot;
zj@a:~/code/esp32/std$
zj@a:~/code/esp32/std$ cat .cargo/config.toml
[build]
target = &quot;xtensa-esp32s3-espidf&quot;

[target.xtensa-esp32s3-espidf]
linker = &quot;ldproxy&quot;
# runner = &quot;espflash --monitor&quot; # Select this runner for espflash v1.x.x
runner = &quot;espflash flash --monitor&quot; # Select this runner for espflash v2.x.x
rustflags = [ &quot;--cfg&quot;,  &quot;espidf_time64&quot;] # Extending time_t for ESP IDF 5: https://github.com/esp-rs/rust/issues/110

[unstable]
build-std = [&quot;std&quot;, &quot;panic_abort&quot;]

[env]
MCU=&quot;esp32s3&quot;
# Note: this variable is not used by the pio builder (`cargo build --features pio`)
ESP_IDF_VERSION = &quot;v5.2.1&quot;
ESP_IDF_SDKCONFIG_DEFAULTS = { value = &quot;sdkconfig.defaults&quot;, relative = true }

zj@a:~/code/esp32/std$ cat rust-toolchain.toml
[toolchain]
channel = &quot;esp&quot;</span></span></span></code></pre><div id="https://www.notion.so/d604a4b925424ea784e50aee5aab066b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">non_std workspace:</mark></span></span></p></div><div id="https://www.notion.so/c423ab789c4f4e108d73ea9577bbc117" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">Copy</mark></span></span></p></div><pre id="https://www.notion.so/1829ef6c0c3b49669130a271dbb2f695" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>zj@a:~/code/esp32/non_std$ cat Cargo.toml
[workspace]
resolver = &quot;2&quot;
members = [
  &quot;myesp-nonstd&quot;
]

[profile.dev]
# Rust debug is too slow.
# For debug builds always builds with some optimization
opt-level = &quot;s&quot;

[profile.release]
codegen-units = 1 # LLVM can perform better optimizations using a single thread
debug = 2
debug-assertions = false
incremental = false
lto = &#x27;fat&#x27;
opt-level = &#x27;s&#x27;
overflow-checks = false

zj@a:~/code/esp32/non_std$ cat .cargo/config.toml
[target.xtensa-esp32s3-none-elf]
runner = &quot;espflash flash --monitor&quot;


[env]
ESP_LOGLEVEL=&quot;INFO&quot;

[build]
rustflags = [
  &quot;-C&quot;, &quot;link-arg=-nostartfiles&quot;,
]

target = &quot;xtensa-esp32s3-none-elf&quot;

[unstable]
build-std = [&quot;core&quot;]

zj@a:~/code/esp32/non_std$ cat rust-toolchain.toml
[toolchain]
channel = &quot;esp&quot;
zj@a:~/code/esp32/non_std$</span></span></span></code></pre><div id="https://www.notion.so/21b4724d3ec34105a811103ac4d43edc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">æ–°å¢åº”ç”¨ï¼š</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/f584bb561569428d8a362c771c2376d7" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">åœ¨å¯¹åº”çš„ std/non_std ç›®å½•ä¸‹ä½¿ç”¨ cargo generate æ¨¡æ¿æ¥åˆ›å»ºåº”ç”¨ã€‚</mark></span></span></li><li id="https://www.notion.so/c591bc78b99640e1a6f11cdfdf90c20b" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ç„¶åå°†åº”ç”¨åç§°æ·»åŠ åˆ° members åˆ—è¡¨ä¸­ï¼›</mark></span></span></li></ol><div id="https://www.notion.so/8a8e96bc88614a6dbe4be25d57a5bb8f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">æ„å»ºåº”ç”¨ï¼š</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/0bd262d4726b44b4bf1c9457c373047b" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">åœ¨ std/non_std workspace æ ¹ç›®å½•ä¸‹ï¼š cargo build -p app1</mark></span></span></li><li id="https://www.notion.so/a98d0677bec84904a48f22132a1cc58e" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">åœ¨ç‰¹å®šåº”ç”¨ç›®å½•ï¼Œå¦‚ std/myespv2 ç›®å½•ä¸‹ï¼š cargo build # åªæ„å»ºå½“å‰åº”ç”¨</mark></span></span></li></ol><div id="https://www.notion.so/5a453947428b4d6490f9b6dc3cfa9dbf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">å½“åº”ç”¨ä½äº workspace ä¸­ï¼ˆmembers åˆ—è¡¨ä¸­ï¼‰ æ—¶ï¼Œcargo build </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">ä¸å†è¯»å–åº”ç”¨ç›®å½•ä¸­çš„</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> ä¸‹åˆ—æ–‡ä»¶ï¼Œè€Œæ˜¯éƒ½ä½¿ç”¨ workspaces ç›®å½•ä¸‹çš„å¯¹åº”æ–‡ä»¶ã€‚</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/6b2a5885b0694dadafb8ee6ff9671d1e" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">rust-toolchain.toml</mark></span></span></li><li id="https://www.notion.so/08fe51c77d9141928dc2733340f73514" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">.cargo/config.toml</mark></span></span></li><li id="https://www.notion.so/c19f99449d4a40c2b8e2a57126d18b8a" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">sdkconfig.defaults å’Œ sdkconfig.defaults.esp32s3 # ç›¸å¯¹ä¸ workspace ç›®å½•ã€‚</mark></span></span></li></ol><div id="https://www.notion.so/627778404de7454c9afeb0abd20c6c2d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ä½†æ˜¯åº”ç”¨ç›®å½•ä¸‹çš„ Cargo.toml å’Œ build.rs è¿˜æ˜¯å¿…é¡»çš„ï¼Œåˆ†åˆ«æŒ‡å®šå„åº”ç”¨è‡ªèº«çš„ä¾èµ–å’Œæ„å»ºè„šæœ¬ã€‚</mark></span></span></p></div></article>
  <footer class="Footer">
  <div>
    &copy; 413â€™s Website 2020~2024
  </div>
  <div>
    &centerdot;
  </div>
  <div>
    Powered by
    <a href="https://github.com/syx-413" target="_blank" rel="noopener noreferrer"> notablog</a>.
  </div>
</footer>
</body>

</html>