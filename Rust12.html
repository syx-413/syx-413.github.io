<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<!-- ------- for latex â†‘  -->
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<link rel="stylesheet" type="text/css" href="css/CustomSetting.css">
<!-- Favicon -->

<link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¥¥&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>Rust é©±åŠ¨ LCD - æ˜¾ç¤ºå›¾ç‰‡&nbsp;|&nbsp;413â€™s Website</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="Rust é©±åŠ¨ LCD - æ˜¾ç¤ºå›¾ç‰‡">
  
    <meta name="description" content="JPEGè§£ç  ç¡¬ä»¶ç¼–ç  è§£ç ">
    <meta property="og:description" content="JPEGè§£ç  ç¡¬ä»¶ç¼–ç  è§£ç ">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¦€&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
      <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¥¥&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="blog-collection.html">
    <div class="Navbar__Btn">
      
      <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¥…&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>blog mark</span>
    </div>
  </a>
  
  
  
  
  
  
  
  
  
  
  
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="Note.html">
    <div class="Navbar__Btn">
      
      <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¶&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Note</span>
    </div>
  </a>
  
  
  
  
  
  
  
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="homre.html">
    <div class="Navbar__Btn">
      
      <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸŒˆ&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>413â€™s Website bar</span>
    </div>
  </a>
  
  
  
  
  
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="reference.html">
    <div class="Navbar__Btn">
      
      <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ˜·&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>æ‚é¡¹</span>
    </div>
  </a>
  
  
  
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="About.html">
    <div class="Navbar__Btn">
      
      <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¤“&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>About</span>
    </div>
  </a>
  
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¦€&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">Rust é©±åŠ¨ LCD - æ˜¾ç¤ºå›¾ç‰‡</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Mon, Sep 2, 2024</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a href="tag/Rust.html">Rust</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--red">
            <a href="tag/å•ç‰‡æœº.html">å•ç‰‡æœº</a>
          </span>
        
      </div>
    
  </header>
    <div id="content-html"></div>
  <article id="https://www.notion.so/585d3ae54a0341fbaa29a5cfc3328dc3" class="PageRoot PageRoot--FullWidth"><h1 id="https://www.notion.so/100fc3f52a8880b5a5b5ddf8ee249d7f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/100fc3f52a8880b5a5b5ddf8ee249d7f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Rust é©±åŠ¨ LCD - æ˜¾ç¤ºå›¾ç‰‡</span></span></h1><div id="https://www.notion.so/dffbff8bc7b4470f92a34bb479aaca3e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/a69aa32ca1e248f4a26428139b124daf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ä¸€ä¸ª LCD å°æ¸¸æˆï¼š</mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/georgik/esp32-spooky-maze-game/blob/main/esp32-s3-usb-otg/src/main.rs"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">esp32-spooky-maze-game</mark></a></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/0fce70bcf7c74193866dbc22354f0b3e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ä½¿ç”¨çš„æ˜¯ </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">mipidsi::Builder::st7789</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ï¼Œéœ€è¦ä¿®æ”¹ä¸º </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">st7735s</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ï¼Œæ”¯æŒæŒ‰é”®ã€‚</mark></span></span></li><li id="https://www.notion.so/0349b3e6766e485c84411d4ff72f1678" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">xtensa-esp32s3-none-elf non_std</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> åº”ç”¨ã€‚</mark></span></span></li></ul><div id="https://www.notion.so/12cafb793ee94a5db2b1ba73c5e182e8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">å¦å¤–ä¸€ä¸ª LCD é¡¹ç›®æ ·ä¾‹ï¼š </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/georgik/esp32-rust-multi-target-template/blob/main/esp32-s3-usb-otg/src/main.rs"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://github.com/georgik/esp32-rust-multi-target-template/blob/main/esp32-s3-usb-otg/src/main.rs</mark></a></span></span></p></div><div id="https://www.notion.so/8de3a4efef0b4a0f808e2cb72ee03510" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ESP Display Interface with SPI and DMAï¼š </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/georgik/esp-display-interface-spi-dma/blob/main/README.md"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://github.com/georgik/esp-display-interface-spi-dma/blob/main/README.md</mark></a></span></span></p></div><div id="https://www.notion.so/dfa4eb6e66a0449fad8dbd419dd58edd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">å‚è€ƒæ–‡æ¡£ï¼š</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/63318c824a6a4c368f3410aec3ac4d73" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://docs.espressif.com/projects/esp-iot-solution/en/latest/display/lcd/index.html"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://docs.espressif.com/projects/esp-iot-solution/en/latest/display/lcd/index.html</mark></a></span></span></li><li id="https://www.notion.so/c7d08b6046ad48f48b609ebd95891698" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.makerfabs.com/esp32-3-5-inch-tft-touch-capacitive-with-camera.html"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://www.makerfabs.com/esp32-3-5-inch-tft-touch-capacitive-with-camera.html</mark></a></span></span></li></ol><div id="https://www.notion.so/f73bfb735b3e4872983d79411a878eb1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">LCD å’Œ Touch ä¸€èˆ¬é›†æˆåœ¨ä¸€å—å±å¹•ä¸Šï¼ˆéƒ¨åˆ† Touch è¿˜æ”¯æŒå›ºå®šçš„è§¦æ‘¸æŒ‰é’®ï¼‰ï¼Œæ‰€ä»¥ esp-idf æä¾›äº† lcd_panel å¯¹è±¡æ¥ç»¼åˆç®¡ç† LCD å’Œ Touchã€‚</mark></span></span></p></div><div id="https://www.notion.so/4fcaf5d57f1f4f6bbd0702f1a67c878f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">å¸¸ç”¨ LCD æ¥å£ï¼š</mark></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/28eec7a2a91446e9a8886b2b7566472a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">SPIï¼š1 bit æ•°æ®çº¿ï¼ŒLCD éœ€è¦æ”¯æŒ GRAMï¼›</mark></span></span></li><li id="https://www.notion.so/244bcd8f62a240878f6cc3ee647a5c2f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">QSPIï¼ˆQuad-SPIï¼‰ï¼š4 bit æ•°æ®çº¿ï¼ŒLCD æˆ– MCU éœ€è¦æ”¯æŒ GRAMï¼›</mark></span></span></li><li id="https://www.notion.so/7e2718d6d90443b8a63e0cad0a8db34d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">I80 æˆ–ç§° I8080ï¼ˆDBIï¼‰: 8/16 bit æ•°æ®çº¿ï¼ŒåŸºäº I80 æ€»çº¿åè®®ï¼Œ </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">LCD éœ€è¦æ”¯æŒ GRAM</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> ï¼›</mark></span></span></li><li id="https://www.notion.so/e6afb0ff3d5341eb994f82292978646b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">RGBï¼ˆDPIï¼‰ï¼š8/16/18/24 bit æ•°æ®çº¿ï¼ŒLCD ä¸éœ€è¦æ”¯æŒ GRAMï¼Œ </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">ä¸€èˆ¬å’Œ 3çº¿ SPI å…±ç”¨</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> ã€‚</mark></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/37b8fadd127e4318b3cc4d75a08ca8c8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">Camera ä¸€èˆ¬ä¹Ÿä½¿ç”¨ RGB æ¥å£ï¼ŒåŒ…å« HSYNC/VSYNC ä¿¡å·ï¼Œæ‰€ä»¥åœ¨ esp-idf åº“ä¸­ module ä¸º lcd_camera.</mark></span></span></li></ul></li><li id="https://www.notion.so/281924aac4794e7b93038652c22695d1" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">MIPI-DSIï¼š1/2/3/4 bit ä¸²è¡Œæ¥å£ï¼Œä½¿ç”¨é«˜é€Ÿå·®åˆ†ä¿¡å·å’Œ D-PHY æ”¶å‘å™¨ï¼ˆç±»ä¼¼äº USBï¼‰ï¼Œç›®å‰åªæœ‰ ESP32-P4 æ”¯æŒã€‚å±äºä¼ è¾“é€Ÿç‡æœ€å¿«çš„æ¥å£</mark></span></span></li></ul><div id="https://www.notion.so/7c70c62433214f4e9b56812d7cc57c6a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://docs.espressif.com/projects/esp-iot-solution/en/latest/display/lcd/lcd_guide.html"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://docs.espressif.com/projects/esp-iot-solution/en/latest/display/lcd/lcd_guide.html</mark></a></span></span></p></div><div id="https://www.notion.so/d80f701f856b4880a707d35b194dd9bf" class="Image Image--Normal"><figure><a href="#?width=720"><img src="#?width=720" style="width:720px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/bcb8bb7a9c34441488f19ea54f56b311" class="Image Image--Normal"><figure><a href="#?width=720"><img src="#?width=720" style="width:720px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/b450b3e3aa6244429caae01f70994812" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/espressif/esp-idf/tree/master/examples/peripherals/lcd"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">esp-idf/examples/peripherals/lcd/</mark></a></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> ç›®å½•åŒ…å«è¿™äº›æ¥å£çš„ LCD é©±åŠ¨ï¼š</mark></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/a4c1772e26884b24871ffcc30e601ab0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">i2c_oledï¼šä¸€èˆ¬æ˜¯å°å‹çš„ OLED LCD å±å¹•ä½¿ç”¨ I2Cï¼›</mark></span></span></li><li id="https://www.notion.so/8aede1ac43304f798917073dbdea8361" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">i80_controllerï¼šIntel 8080 interfaced</mark></span></span></li><li id="https://www.notion.so/bd396cc4ae3d4823a1707db8ab9c65cb" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">mipi_dsiï¼šæœ€é«˜æ•ˆçš„ä¸²è¡Œæ¥å£ï¼›</mark></span></span></li><li id="https://www.notion.so/a5b8d1768fff465aab4f3fb85ba0c643" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">rgb_panel</mark></span></span></li><li id="https://www.notion.so/2b4958e43d244bb5bebd9174ff1ed8c6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">spi_lcd_touch</mark></span></span></li><li id="https://www.notion.so/c74e8a338f5947b89f6b362486dbca49" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">tjpgd ï¼šJPEG è½¯è§£å‹åº“ï¼›</mark></span></span></li></ul><div id="https://www.notion.so/058dd187e1744d408dfc58e4d797ae8b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/espressif/esp-iot-solution/tree/ce4c75dc/examples/display/lcd"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">esp-iot-solution/examples/display/lcd/</mark></a></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> ç›®å½•ä¹ŸåŒ…å«ä¸€äº› LCD ä¾‹å­ï¼š</mark></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/7e2cf4024057452ea3cb8c0a8af8357f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">lcd_with_te</mark></span></span></li><li id="https://www.notion.so/59ddc824c03348029b45f4c0bce3d991" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">qspi_with_ram</mark></span></span></li><li id="https://www.notion.so/2c08e83e184a4e489804de15921fc40a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">qspi_without_ram</mark></span></span></li><li id="https://www.notion.so/9bf06643126b43b485d5d4f303c118d8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">rgb_avoid_tearing</mark></span></span></li><li id="https://www.notion.so/d5a92b1355824d95994693f790d698c8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">rgb_lcd_8bit</mark></span></span></li></ul><h2 id="https://www.notion.so/d9cac5a6d0e241149f1e33770327fd8e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/d9cac5a6d0e241149f1e33770327fd8e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">1 æ˜¾ç¤º raw å›¾ç‰‡ </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://blog.opsnull.com/rust-embedded/rust-esp32-lcd-picture/#%E6%98%BE%E7%A4%BA-raw-%E5%9B%BE%E7%89%87"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></a></span></span></h2><div id="https://www.notion.so/cac7a2c3688d4b34a53a4e4503f4ab74" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">raw å›¾ç‰‡æ˜¯æŒ‡ RGB888/RGB565 ç­‰æ ¼å¼çš„å›¾ç‰‡ã€‚</mark></span></span></p></div><div id="https://www.notion.so/52b243be8a7b4f98ab515c80deda4300" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">åƒç´ æ ¼å¼ä¸»è¦åˆ†ä¸º YUV å’Œ RGB ä¸¤ç§å¤§ç±»ï¼š</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/0cadacbb06bd4ba59fb7f30ac962e1c3" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">YUV422: ä¹Ÿç§°ä¸º YCbCrï¼šY äº®åº¦ï¼ŒU/Cbï¼šè“è‰²æµ“åº¦ï¼ŒV/Crï¼šçº¢è‰²æµ“åº¦ï¼›</mark></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/d8c927552cd44d2d877b183b934b8b13" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ä¸ºäº†èŠ‚çœå¸¦å®½ YUV frame ä¸€èˆ¬ä½¿ç”¨é‡‡æ ·ï¼Œå¦‚ YUV422 è¡¨ç¤º 2:1çš„æ°´å¹³å–æ ·ï¼Œå‚ç›´å®Œå…¨é‡‡æ ·ï¼›</mark></span></span></li></ul></li><li id="https://www.notion.so/a26116b28ac344e3bdeb33d1d41d9469" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">RGB888ï¼šä¹Ÿç§° 24-bit RGBï¼Œå„ä½¿ç”¨ 8bit æ¥è¡¨ç¤º red/green/blueï¼›</mark></span></span></li><li id="https://www.notion.so/c934efc8dbf045beb61d06c7f100601f" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">RGB666: ä¹Ÿç§° 18-bit RGB</mark></span></span></li><li id="https://www.notion.so/35e5eaf2da87454e8e94e61f9e8a4508" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">RGB565ï¼šä¹Ÿç§° 16-bit RGBï¼Œ5 bits for the red channel, 6 bits for the green channel, and 5 bits for the blue channel. ç›¸æ¯” RGB888ï¼Œæ›´èŠ‚çœèµ„æºï¼›</mark></span></span></li></ol><div id="https://www.notion.so/0abb4b4f280b475b9726b22f413ee1c8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">YUV å’Œ RGB ä¹‹é—´å¯ä»¥ç›¸äº’è½¬æ¢ã€‚</mark></span></span></p></div><div id="https://www.notion.so/1b3658f0e78f483b87080f5262bd14ec" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">LCD ä¸€èˆ¬ä½¿ç”¨ RGB åƒç´ æ ¼å¼ï¼Œè€Œä¸”æ˜¯æ¯”è¾ƒèŠ‚çœç©ºé—´çš„ 16-bit çš„ RGB565 åƒç´ æ ¼å¼ï¼š</mark></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/d89ea525bbde41409b2e3ed9b73cfb3f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">camera å¯ä»¥ç›´æ¥äº§ç”Ÿ RGB565 æ•°æ®ï¼Œå¯ä»¥ç›´æ¥åœ¨ LCD æ˜¾ç¤ºï¼›</mark></span></span></li><li id="https://www.notion.so/53bf0d841fd24280a43da4d7441edd84" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">bmp/png/jpeg ç­‰å›¾ç‰‡æ ¼å¼ï¼Œéœ€è¦å°†åƒç´ è½¬æ¢ä¸º RGB565 åæ‰èƒ½ä¾› LCD æ˜¾ç¤ºï¼›</mark></span></span></li></ul><div id="https://www.notion.so/cffa329baa5942a4ab3473fd47f5b0b2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">éœ€è¦å°† JPEG è§£ç æˆ– bmp ä¸­çš„åƒç´ æ•°æ®è½¬æ¢ä¸º RGB888, RGB565 ç­‰æ ¼å¼çš„ raw picture åï¼ŒLCD æ‰èƒ½ç›´æ¥æ˜¾ç¤ºã€‚</mark></span></span></p></div><div id="https://www.notion.so/1d6bdb12c4fc4f53a01a842eb3e6cf43" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">Copy</mark></span></span></p></div><div id="https://www.notion.so/76291580fe65443287f89f12d116b82d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">æˆ–è€…ä½¿ç”¨ LVGL æä¾›çš„åœ¨çº¿è½¬æ¢å·¥å…·ï¼š</mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://lvgl.io/tools/imageconverter"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://lvgl.io/tools/imageconverter</mark></a></span></span></p></div><div id="https://www.notion.so/3666c8b16c2348faaeeb41aa6e5d7c9c" class="Image Image--PageWidth"><figure><a href="#?width=834"><img src="#?width=834" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/18333c83a8c8409a8e3294a0e5a25ca4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">å¯ä»¥ä½¿ç”¨ OpenCV åº“æ¥æ˜¾ç¤º raw data picutreï¼š</mark></span></span></p></div><div id="https://www.notion.so/c58b6d41ae734d93adca7979758cecc8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/bfb39069a2584ab7be97cef9866e3bfe" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment"># https://github.com/espressif/esp-idf/blob/master/examples/peripherals/jpeg/jpeg_decode/open_raw_picture.py</span>

<span class="token comment"># SPDX-FileCopyrightText: 2024 Espressif Systems (Shanghai) CO LTD</span>
<span class="token comment"># SPDX-License-Identifier: Unlicense OR CC0-1.0</span>
<span class="token keyword">import</span> argparse

<span class="token keyword">import</span> cv2 <span class="token keyword">as</span> cv
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>typing <span class="token keyword">import</span> NDArray


<span class="token keyword">def</span> <span class="token function">open_picture</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (str) -> list[int]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    new_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> data<span class="token punctuation">]</span>
    <span class="token keyword">return</span> new_data


<span class="token keyword">def</span> <span class="token function">picture_show_rgb888</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>
    data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">picture_show_rgb565</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>

    new_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            new_data<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf8</span><span class="token punctuation">)</span>
            new_data<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x7</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            new_data<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> i <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span>
            new_data<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> i <span class="token operator">//</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xe0</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">3</span>

    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>new_data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> new_data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">picture_show_gray</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>
    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> new_data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">convert_YUV_to_RGB</span><span class="token punctuation">(</span>Y<span class="token punctuation">,</span> U<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (NDArray, NDArray, NDArray) -> tuple[NDArray, NDArray, NDArray]</span>
    B <span class="token operator">=</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>Y <span class="token operator">+</span> <span class="token number">1.7790</span> <span class="token operator">*</span> <span class="token punctuation">(</span>U <span class="token operator">-</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    G <span class="token operator">=</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>Y <span class="token operator">-</span> <span class="token number">0.3455</span> <span class="token operator">*</span> <span class="token punctuation">(</span>U <span class="token operator">-</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.7169</span> <span class="token operator">*</span> <span class="token punctuation">(</span>V <span class="token operator">-</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    R <span class="token operator">=</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>Y <span class="token operator">+</span> <span class="token number">1.4075</span> <span class="token operator">*</span> <span class="token punctuation">(</span>V <span class="token operator">-</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>

    <span class="token keyword">return</span> B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R


<span class="token keyword">def</span> <span class="token function">picture_show_yuv420</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>
    new_u <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h <span class="token operator">*</span> w<span class="token punctuation">)</span>
    new_v <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h <span class="token operator">*</span> w<span class="token punctuation">)</span>
    new_y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h <span class="token operator">*</span> w<span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>h <span class="token operator">*</span> w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        is_even_row <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> is_even_row<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                new_u<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
                new_u<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                new_u<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> new_u<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span>
                new_u<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> new_u<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>h <span class="token operator">*</span> w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            idx <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>
            new_v<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            new_v<span class="token punctuation">[</span>idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>h <span class="token operator">*</span> w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            idx <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>
            new_v<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> new_v<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span>
            new_v<span class="token punctuation">[</span>idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> new_v<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>

    new_y <span class="token operator">=</span> <span class="token punctuation">[</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>h <span class="token operator">*</span> w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">]</span>

    Y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>new_y<span class="token punctuation">)</span>
    U <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>new_u<span class="token punctuation">)</span>
    V <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>new_v<span class="token punctuation">)</span>

    B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R <span class="token operator">=</span> convert_YUV_to_RGB<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> U<span class="token punctuation">,</span> V<span class="token punctuation">)</span>
    <span class="token comment"># Merge channels</span>
    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>new_data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>

    <span class="token comment"># Display the image</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> new_data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">picture_show_yuv422</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>
    <span class="token comment"># Reshape the input data to a 2D array</span>
    data_array <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token comment"># Separate Y, U, and V channels</span>
    Y <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
    U <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    V <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># Convert YUV to RGB</span>
    B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R <span class="token operator">=</span> convert_YUV_to_RGB<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> U<span class="token punctuation">,</span> V<span class="token punctuation">)</span>

    <span class="token comment"># Merge channels</span>
    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># Display the image</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> new_data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">picture_show_yuv444</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>
    <span class="token comment"># Reshape the input data to a 2D array</span>
    data_array <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span>

    <span class="token comment"># Separate Y, U, and V channels</span>
    Y <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
    U <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
    V <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>

    <span class="token comment"># Convert YUV to RGB</span>
    B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R <span class="token operator">=</span> convert_YUV_to_RGB<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> U<span class="token punctuation">,</span> V<span class="token punctuation">)</span>

    <span class="token comment"># Merge channels</span>
    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># Display the image</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> new_data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: () -> None</span>
    parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">'which mode need to show'</span><span class="token punctuation">)</span>

    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>
        <span class="token string">'--pic_path'</span><span class="token punctuation">,</span>
        <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span>
        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'What is the path of your picture'</span><span class="token punctuation">,</span>
        required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>
        <span class="token string">'--pic_type'</span><span class="token punctuation">,</span>
        <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span>
        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'What type you want to show'</span><span class="token punctuation">,</span>
        required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        choices<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'rgb565'</span><span class="token punctuation">,</span> <span class="token string">'rgb888'</span><span class="token punctuation">,</span> <span class="token string">'gray'</span><span class="token punctuation">,</span> <span class="token string">'yuv422'</span><span class="token punctuation">,</span> <span class="token string">'yuv420'</span><span class="token punctuation">,</span> <span class="token string">'yuv444'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>
        <span class="token string">'--height'</span><span class="token punctuation">,</span>
        <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">,</span>
        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'the picture height'</span><span class="token punctuation">,</span>
        default<span class="token operator">=</span><span class="token number">480</span><span class="token punctuation">)</span>

    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>
        <span class="token string">'--width'</span><span class="token punctuation">,</span>
        <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">,</span>
        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'the picture width'</span><span class="token punctuation">,</span>
        default<span class="token operator">=</span><span class="token number">640</span><span class="token punctuation">)</span>

    args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>

    height <span class="token operator">=</span> args<span class="token punctuation">.</span>height
    width <span class="token operator">=</span> args<span class="token punctuation">.</span>width

    data <span class="token operator">=</span> open_picture<span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_path<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'rgb565'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_rgb565<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'rgb888'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_rgb888<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'gray'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_gray<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'yuv420'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_yuv420<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'yuv422'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_yuv422<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'yuv444'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_yuv444<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'This type is not supported in this script!'</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span></code></pre><h2 id="https://www.notion.so/ece6f8c0a4d94e05841d327cbf2efb2f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/ece6f8c0a4d94e05841d327cbf2efb2f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">2 æ˜¾ç¤º png å›¾ç‰‡ </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://blog.opsnull.com/rust-embedded/rust-esp32-lcd-picture/#%E6%98%BE%E7%A4%BA-png-%E5%9B%BE%E7%89%87"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></a></span></span></h2><div id="https://www.notion.so/50c5347b38d54d858d7f0b537b04f1db" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ä½¿ç”¨å¦‚ä¸‹ python ä»£ç å°† png å›¾ç‰‡è½¬æ¢ä¸º raw RGB 565 formatï¼š</mark></span></span></p></div><div id="https://www.notion.so/68b6f147259843e5bb95473a42d21722" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/65ae3ec1564a46a4baa07ff6e1939b99" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">#!/usr/bin/python</span>

<span class="token keyword">import</span> sys
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image

<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
    <span class="token comment"># print "\nReading: " + sys.argv[1]</span>
    out <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
    out <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span> <span class="token string">"Usage: png2fb.py infile [outfile]"</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

im <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> im<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">"RGB"</span><span class="token punctuation">:</span>
    pixelSize <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">elif</span> im<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">"RGBA"</span><span class="token punctuation">:</span>
    pixelSize <span class="token operator">=</span> <span class="token number">4</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token string">'not supported pixel mode: "%s"'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>im<span class="token punctuation">.</span>mode<span class="token punctuation">)</span><span class="token punctuation">)</span>

pixels <span class="token operator">=</span> im<span class="token punctuation">.</span>tostring<span class="token punctuation">(</span><span class="token punctuation">)</span>
pixels2 <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pixels<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> pixelSize<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pixels2 <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>pixels<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">3</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>pixels<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span> <span class="token operator">&amp;</span> <span class="token number">0xe0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    pixels2 <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>pixels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xf8</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>pixels<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">5</span> <span class="token operator">&amp;</span> <span class="token number">0x07</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>pixels2<span class="token punctuation">)</span>
out<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span></code></pre><h2 id="https://www.notion.so/0fa7bfd08b3a41abad808109e5bb9a77" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/0fa7bfd08b3a41abad808109e5bb9a77"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">3 æ˜¾ç¤º bmp å›¾ç‰‡ </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://blog.opsnull.com/rust-embedded/rust-esp32-lcd-picture/#%E6%98%BE%E7%A4%BA-bmp-%E5%9B%BE%E7%89%87"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></a></span></span></h2><div id="https://www.notion.so/5bd48f36f7a9423f92d8c942d6dbc573" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">bmp å›¾ç‰‡æ˜¯æœªç»å‹ç¼©çš„åƒç´  bit æ–‡ä»¶ï¼ŒåŒ…å« header + åƒç´ æ•°æ®ï¼Œä¸éœ€è¦è§£å‹ç¼©å’Œè½¬ç ï¼Œå¯ä»¥ç›´æ¥è¯»å–ï¼Œè½¬æ¢ä¸º RGB 565 æ ¼å¼ï¼š</mark></span></span></p></div><div id="https://www.notion.so/a8a58b1442594b8fa0424dc97108892d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/af732433cece4675b161d83760b04326" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">// https://github.com/Makerfabs/Project_Touch-Screen-Camera/blob/master/example/SD2TFT/SD2TFT.ino#L205</span>

<span class="token keyword">int</span> <span class="token function">print_img</span><span class="token punctuation">(</span>fs<span class="token double-colon punctuation">::</span>FS <span class="token operator">&amp;</span>fs<span class="token punctuation">,</span> String filename<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    SPI_ON_SD<span class="token punctuation">;</span>
    File f <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>f<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Failed to open file for reading"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    f<span class="token punctuation">.</span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token number">54</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> X <span class="token operator">=</span> <span class="token number">480</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> Y <span class="token operator">=</span> <span class="token number">320</span><span class="token punctuation">;</span>
    <span class="token keyword">uint8_t</span> RGB<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> X<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> row <span class="token operator">&lt;</span> Y<span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        f<span class="token punctuation">.</span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token number">54</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> X <span class="token operator">*</span> row<span class="token punctuation">)</span><span class="token punctuation">;</span>
        f<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>RGB<span class="token punctuation">,</span> <span class="token number">3</span> <span class="token operator">*</span> X<span class="token punctuation">)</span><span class="token punctuation">;</span>
        SPI_OFF_SD<span class="token punctuation">;</span>
        SPI_ON_TFT<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> X<span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            tft<span class="token punctuation">.</span><span class="token function">drawPixel</span><span class="token punctuation">(</span>col<span class="token punctuation">,</span> row<span class="token punctuation">,</span> tft<span class="token punctuation">.</span><span class="token function">color565</span><span class="token punctuation">(</span>RGB<span class="token punctuation">[</span>col <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> RGB<span class="token punctuation">[</span>col <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> RGB<span class="token punctuation">[</span>col <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        SPI_OFF_TFT<span class="token punctuation">;</span>
        SPI_ON_SD<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    f<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    SPI_OFF_SD<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></span></span></span></code></pre><h2 id="https://www.notion.so/0e91b468062f48f5ae7f36271c7332a3" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/0e91b468062f48f5ae7f36271c7332a3"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">4 æ˜¾ç¤º jpeg å›¾ç‰‡ </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://blog.opsnull.com/rust-embedded/rust-esp32-lcd-picture/#%E6%98%BE%E7%A4%BA-jpeg-%E5%9B%BE%E7%89%87"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></a></span></span></h2><div id="https://www.notion.so/0fa3a8d7aee64477aaf8c7f1199d2145" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">JPEG æ˜¯å‹ç¼©å›¾ç‰‡æ ¼å¼ï¼Œåœ¨ LCD æ˜¾ç¤ºå‰éœ€è¦å…ˆå¯¹å…¶è¿›è¡Œè§£å‹ç¼©å’Œè§£ç ï¼Œè½¬æ¢ä¸º LCD ä¸Šæ˜¾ç¤ºçš„ RGB åƒç´ æ•°æ®ï¼ˆraw pictureï¼‰ï¼Œå¦‚ JPEG_RAW_TYPE_RGB565_BEï¼š</mark></span></span></p></div><div id="https://www.notion.so/dc432970344d4ee2bae237d70eb17eab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/42f0c0b9309b415099ee4ae2fa5d80d6" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">// https://github.com/espressif/esp-box/blob/master/examples/usb_camera_lcd_display/main/main.c#L56</span>

<span class="token comment">// å°† JPEG è§£ç ä¸º JPEG_RAW_TYPE_RGB565_BE è¾“å‡ºæ ¼å¼</span>
<span class="token keyword">static</span> <span class="token class-name">jpeg_error_t</span> <span class="token function">esp_jpeg_decoder_one_picture</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>input_buf<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span> <span class="token class-name">uint8_t</span> <span class="token operator">*</span>output_buf<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">esp_err_t</span> ret <span class="token operator">=</span> ESP_OK<span class="token punctuation">;</span>
    <span class="token comment">// Generate default configuration</span>
    <span class="token class-name">jpeg_dec_config_t</span> config <span class="token operator">=</span> <span class="token function">DEFAULT_JPEG_DEC_CONFIG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>output_type <span class="token operator">=</span> JPEG_RAW_TYPE_RGB565_BE<span class="token punctuation">;</span>
    <span class="token comment">// Empty handle to jpeg_decoder</span>
    <span class="token class-name">jpeg_dec_handle_t</span> jpeg_dec <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    <span class="token comment">// Create jpeg_dec</span>
    jpeg_dec <span class="token operator">=</span> <span class="token function">jpeg_dec_open</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Create io_callback handle</span>
    <span class="token class-name">jpeg_dec_io_t</span> <span class="token operator">*</span>jpeg_io <span class="token operator">=</span> <span class="token function">calloc</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">jpeg_dec_io_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>jpeg_io <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> ESP_FAIL<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Create out_info handle</span>
    <span class="token class-name">jpeg_dec_header_info_t</span> <span class="token operator">*</span>out_info <span class="token operator">=</span> <span class="token function">calloc</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">jpeg_dec_header_info_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>out_info <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> ESP_FAIL<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Set input buffer and buffer len to io_callback</span>
    jpeg_io<span class="token operator">-></span>inbuf <span class="token operator">=</span> input_buf<span class="token punctuation">;</span>
    jpeg_io<span class="token operator">-></span>inbuf_len <span class="token operator">=</span> len<span class="token punctuation">;</span>

    <span class="token comment">// Parse jpeg picture header and get picture for user and decoder</span>
    ret <span class="token operator">=</span> <span class="token function">jpeg_dec_parse_header</span><span class="token punctuation">(</span>jpeg_dec<span class="token punctuation">,</span> jpeg_io<span class="token punctuation">,</span> out_info<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">goto</span> _exit<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    jpeg_io<span class="token operator">-></span>outbuf <span class="token operator">=</span> output_buf<span class="token punctuation">;</span>
    <span class="token keyword">int</span> inbuf_consumed <span class="token operator">=</span> jpeg_io<span class="token operator">-></span>inbuf_len <span class="token operator">-</span> jpeg_io<span class="token operator">-></span>inbuf_remain<span class="token punctuation">;</span>
    jpeg_io<span class="token operator">-></span>inbuf <span class="token operator">=</span> input_buf <span class="token operator">+</span> inbuf_consumed<span class="token punctuation">;</span>
    jpeg_io<span class="token operator">-></span>inbuf_len <span class="token operator">=</span> jpeg_io<span class="token operator">-></span>inbuf_remain<span class="token punctuation">;</span>

    <span class="token comment">// Start decode jpeg raw data</span>
    ret <span class="token operator">=</span> <span class="token function">jpeg_dec_process</span><span class="token punctuation">(</span>jpeg_dec<span class="token punctuation">,</span> jpeg_io<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">goto</span> _exit<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

_exit<span class="token operator">:</span>
    <span class="token comment">// Decoder deinitialize</span>
    <span class="token function">jpeg_dec_close</span><span class="token punctuation">(</span>jpeg_dec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>out_info<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>jpeg_io<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">_camera_display</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span>lcd_buffer<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">bsp_display_lock</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ä½¿ç”¨ LVGL æ˜¾ç¤ºè§£ç åçš„ JPEG æ•°æ®</span>
    <span class="token function">lv_canvas_set_buffer</span><span class="token punctuation">(</span>camera_canvas<span class="token punctuation">,</span> lcd_buffer<span class="token punctuation">,</span> current_width<span class="token punctuation">,</span> current_height<span class="token punctuation">,</span> LV_IMG_CF_TRUE_COLOR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">lv_label_set_text_fmt</span><span class="token punctuation">(</span>label<span class="token punctuation">,</span> <span class="token string">"#FF0000 %d*%d#"</span><span class="token punctuation">,</span> current_width<span class="token punctuation">,</span> current_height<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">bsp_display_unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">camera_frame_cb</span><span class="token punctuation">(</span><span class="token class-name">uvc_frame_t</span> <span class="token operator">*</span>frame<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">ESP_LOGI</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">"uvc callback! frame_format = %d, seq = %"</span> PRIu32 <span class="token string">", width = %"</span> PRIu32 <span class="token string">", height = %"</span> PRIu32 <span class="token string">", length = %u, ptr = %d"</span><span class="token punctuation">,</span>
             frame<span class="token operator">-></span>frame_format<span class="token punctuation">,</span> frame<span class="token operator">-></span>sequence<span class="token punctuation">,</span> frame<span class="token operator">-></span>width<span class="token punctuation">,</span> frame<span class="token operator">-></span>height<span class="token punctuation">,</span> frame<span class="token operator">-></span>data_bytes<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>current_width <span class="token operator">!=</span> frame<span class="token operator">-></span>width <span class="token operator">||</span> current_height <span class="token operator">!=</span> frame<span class="token operator">-></span>height<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        current_width <span class="token operator">=</span> frame<span class="token operator">-></span>width<span class="token punctuation">;</span>
        current_height <span class="token operator">=</span> frame<span class="token operator">-></span>height<span class="token punctuation">;</span>
        <span class="token function">adaptive_jpg_frame_buffer</span><span class="token punctuation">(</span>current_width <span class="token operator">*</span> current_height <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">esp_jpeg_decoder_one_picture</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>frame<span class="token operator">-></span>data<span class="token punctuation">,</span> frame<span class="token operator">-></span>data_bytes<span class="token punctuation">,</span> jpg_frame_buf<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è§£ç  JPEG</span>
    <span class="token function">_camera_display</span><span class="token punctuation">(</span>jpg_frame_buf<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ˜¾ç¤º</span>
    <span class="token function">vTaskDelay</span><span class="token punctuation">(</span><span class="token function">pdMS_TO_TICKS</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/73f41c4697fb411e9a97bf6ea613d12a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ä¸Šé¢ä»£ç ä½¿ç”¨çš„ esp_jpeg </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">è½¯ä»¶è§£ç åº“</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/espressif/idf-extra-components/tree/master/esp_jpeg"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">JPEG Decoder: TJpgDec -Tiny JPEG Decompressor</mark></a></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/d6b2fa0f1c1e4785b7a0a1d5877307d6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">Output Pixel Format: RGB888, RGB565</mark></span></span></li><li id="https://www.notion.so/67924dbb736c47bdbcf0c73be33da8ca" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">Scaling Ratio: 1/1, 1/2, 1/4 or 1/8 Selectable on Decompression</mark></span></span></li></ul><div id="https://www.notion.so/e565d2941c354730be189fbe72dfbc2b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">å¦ä¸€ä¸ª </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/espressif/esp-idf/tree/master/examples/peripherals/lcd/tjpgd"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">LCD tjpgd example</mark></a></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ï¼šThis example shows how to decode a jpeg image and display it on an SPI-interfaced LCD, and rotates the image periodically.</mark></span></span></p></div><div id="https://www.notion.so/31604b70948f49d1b6851bfb4fea9e78" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/7bc2ada96055474e99947a6d7ac29aaf" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">// https://github.com/espressif/esp-idf/blob/master/examples/peripherals/lcd/tjpgd/main/decode_image.c</span>

<span class="token comment">//Decode the embedded image into pixel lines that can be used with the rest of the logic.</span>
<span class="token class-name">esp_err_t</span> <span class="token function">decode_image</span><span class="token punctuation">(</span><span class="token class-name">uint16_t</span> <span class="token operator">*</span><span class="token operator">*</span>pixels<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token operator">*</span>pixels <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token class-name">esp_err_t</span> ret <span class="token operator">=</span> ESP_OK<span class="token punctuation">;</span>
    
    <span class="token comment">//Alocate pixel memory. Each line is an array of IMAGE_W 16-bit pixels; the `*pixels` array itself contains pointers to these lines.</span>
    <span class="token operator">*</span>pixels <span class="token operator">=</span> <span class="token function">calloc</span><span class="token punctuation">(</span>IMAGE_H <span class="token operator">*</span> IMAGE_W<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uint16_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ESP_GOTO_ON_FALSE</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>pixels<span class="token punctuation">)</span><span class="token punctuation">,</span> ESP_ERR_NO_MEM<span class="token punctuation">,</span> err<span class="token punctuation">,</span> TAG<span class="token punctuation">,</span> <span class="token string">"Error allocating memory for lines"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//JPEG decode config</span>
    <span class="token class-name">esp_jpeg_image_cfg_t</span> jpeg_cfg <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span>indata <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>image_jpg_start<span class="token punctuation">,</span>
        <span class="token punctuation">.</span>indata_size <span class="token operator">=</span> image_jpg_end <span class="token operator">-</span> image_jpg_start<span class="token punctuation">,</span>
        <span class="token punctuation">.</span>outbuf <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>pixels<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>outbuf_size <span class="token operator">=</span> IMAGE_W <span class="token operator">*</span> IMAGE_H <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uint16_t</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>out_format <span class="token operator">=</span> JPEG_IMAGE_FORMAT_RGB565<span class="token punctuation">,</span>
        <span class="token punctuation">.</span>out_scale <span class="token operator">=</span> JPEG_IMAGE_SCALE_0<span class="token punctuation">,</span>
        <span class="token punctuation">.</span>flags <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token punctuation">.</span>swap_color_bytes <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">//JPEG decode</span>
    <span class="token class-name">esp_jpeg_image_output_t</span> outimg<span class="token punctuation">;</span>
    <span class="token function">esp_jpeg_decode</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>jpeg_cfg<span class="token punctuation">,</span> <span class="token operator">&amp;</span>outimg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">ESP_LOGI</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">"JPEG image decoded! Size of the decoded image is: %dpx x %dpx"</span><span class="token punctuation">,</span> outimg<span class="token punctuation">.</span>width<span class="token punctuation">,</span> outimg<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
err<span class="token operator">:</span>
    <span class="token comment">//Something went wrong! Exit cleanly, de-allocating everything we allocated.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>pixels <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">free</span><span class="token punctuation">(</span><span class="token operator">*</span>pixels<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/3f6c17b71c314585a4c1c7c31f90b5d3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">å¯¹äº JPEG è§£ç ç”Ÿæˆçš„å¯ä»¥ LCD æ˜¾ç¤ºçš„ RGB888, RGB565 ç­‰æ ¼å¼çš„ raw pictureï¼Œ å¯ä»¥ä½¿ç”¨ OpenCV åº“æ¥æ˜¾ç¤ºï¼š</mark></span></span></p></div><div id="https://www.notion.so/a5647e69211a40c5816215c5e4ea93e3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/b4b0506cecb94de9ae0b23930d6f7960" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment"># https://github.com/espressif/esp-idf/blob/master/examples/peripherals/jpeg/jpeg_decode/open_raw_picture.py</span>

<span class="token comment"># SPDX-FileCopyrightText: 2024 Espressif Systems (Shanghai) CO LTD</span>
<span class="token comment"># SPDX-License-Identifier: Unlicense OR CC0-1.0</span>
<span class="token keyword">import</span> argparse

<span class="token keyword">import</span> cv2 <span class="token keyword">as</span> cv
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>typing <span class="token keyword">import</span> NDArray


<span class="token keyword">def</span> <span class="token function">open_picture</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (str) -> list[int]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    new_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> data<span class="token punctuation">]</span>
    <span class="token keyword">return</span> new_data


<span class="token keyword">def</span> <span class="token function">picture_show_rgb888</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>
    data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">picture_show_rgb565</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>

    new_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            new_data<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf8</span><span class="token punctuation">)</span>
            new_data<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x7</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            new_data<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> i <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span>
            new_data<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> i <span class="token operator">//</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xe0</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">3</span>

    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>new_data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> new_data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">picture_show_gray</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>
    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> new_data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">convert_YUV_to_RGB</span><span class="token punctuation">(</span>Y<span class="token punctuation">,</span> U<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (NDArray, NDArray, NDArray) -> tuple[NDArray, NDArray, NDArray]</span>
    B <span class="token operator">=</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>Y <span class="token operator">+</span> <span class="token number">1.7790</span> <span class="token operator">*</span> <span class="token punctuation">(</span>U <span class="token operator">-</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    G <span class="token operator">=</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>Y <span class="token operator">-</span> <span class="token number">0.3455</span> <span class="token operator">*</span> <span class="token punctuation">(</span>U <span class="token operator">-</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.7169</span> <span class="token operator">*</span> <span class="token punctuation">(</span>V <span class="token operator">-</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
    R <span class="token operator">=</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>Y <span class="token operator">+</span> <span class="token number">1.4075</span> <span class="token operator">*</span> <span class="token punctuation">(</span>V <span class="token operator">-</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>

    <span class="token keyword">return</span> B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R


<span class="token keyword">def</span> <span class="token function">picture_show_yuv420</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>
    new_u <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h <span class="token operator">*</span> w<span class="token punctuation">)</span>
    new_v <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h <span class="token operator">*</span> w<span class="token punctuation">)</span>
    new_y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h <span class="token operator">*</span> w<span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>h <span class="token operator">*</span> w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        is_even_row <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> is_even_row<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                new_u<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
                new_u<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                new_u<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> new_u<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span>
                new_u<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> new_u<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>h <span class="token operator">*</span> w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            idx <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>
            new_v<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            new_v<span class="token punctuation">[</span>idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>h <span class="token operator">*</span> w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            idx <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>
            new_v<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> new_v<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span>
            new_v<span class="token punctuation">[</span>idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> new_v<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>

    new_y <span class="token operator">=</span> <span class="token punctuation">[</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>h <span class="token operator">*</span> w <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">]</span>

    Y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>new_y<span class="token punctuation">)</span>
    U <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>new_u<span class="token punctuation">)</span>
    V <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>new_v<span class="token punctuation">)</span>

    B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R <span class="token operator">=</span> convert_YUV_to_RGB<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> U<span class="token punctuation">,</span> V<span class="token punctuation">)</span>
    <span class="token comment"># Merge channels</span>
    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>new_data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>

    <span class="token comment"># Display the image</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> new_data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">picture_show_yuv422</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>
    <span class="token comment"># Reshape the input data to a 2D array</span>
    data_array <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token comment"># Separate Y, U, and V channels</span>
    Y <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
    U <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    V <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># Convert YUV to RGB</span>
    B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R <span class="token operator">=</span> convert_YUV_to_RGB<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> U<span class="token punctuation">,</span> V<span class="token punctuation">)</span>

    <span class="token comment"># Merge channels</span>
    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># Display the image</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> new_data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">picture_show_yuv444</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: (list[int], int, int) -> None</span>
    <span class="token comment"># Reshape the input data to a 2D array</span>
    data_array <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">,</span> w <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span>

    <span class="token comment"># Separate Y, U, and V channels</span>
    Y <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
    U <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
    V <span class="token operator">=</span> data_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>

    <span class="token comment"># Convert YUV to RGB</span>
    B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R <span class="token operator">=</span> convert_YUV_to_RGB<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> U<span class="token punctuation">,</span> V<span class="token punctuation">)</span>

    <span class="token comment"># Merge channels</span>
    new_data <span class="token operator">=</span> np<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> G<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># Display the image</span>
    cv<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> new_data<span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># type: () -> None</span>
    parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">'which mode need to show'</span><span class="token punctuation">)</span>

    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>
        <span class="token string">'--pic_path'</span><span class="token punctuation">,</span>
        <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span>
        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'What is the path of your picture'</span><span class="token punctuation">,</span>
        required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>
        <span class="token string">'--pic_type'</span><span class="token punctuation">,</span>
        <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span>
        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'What type you want to show'</span><span class="token punctuation">,</span>
        required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        choices<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'rgb565'</span><span class="token punctuation">,</span> <span class="token string">'rgb888'</span><span class="token punctuation">,</span> <span class="token string">'gray'</span><span class="token punctuation">,</span> <span class="token string">'yuv422'</span><span class="token punctuation">,</span> <span class="token string">'yuv420'</span><span class="token punctuation">,</span> <span class="token string">'yuv444'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>
        <span class="token string">'--height'</span><span class="token punctuation">,</span>
        <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">,</span>
        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'the picture height'</span><span class="token punctuation">,</span>
        default<span class="token operator">=</span><span class="token number">480</span><span class="token punctuation">)</span>

    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>
        <span class="token string">'--width'</span><span class="token punctuation">,</span>
        <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">,</span>
        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'the picture width'</span><span class="token punctuation">,</span>
        default<span class="token operator">=</span><span class="token number">640</span><span class="token punctuation">)</span>

    args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>

    height <span class="token operator">=</span> args<span class="token punctuation">.</span>height
    width <span class="token operator">=</span> args<span class="token punctuation">.</span>width

    data <span class="token operator">=</span> open_picture<span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_path<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'rgb565'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_rgb565<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'rgb888'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_rgb888<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'gray'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_gray<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'yuv420'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_yuv420<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'yuv422'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_yuv422<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>pic_type <span class="token operator">==</span> <span class="token string">'yuv444'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        picture_show_yuv444<span class="token punctuation">(</span>data<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'This type is not supported in this script!'</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/0efd84218cd74e16a033c28bb6780995" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">é™¤äº†è½¯ä»¶è§£ç å¤–ï¼Œesp32p4(ç›®å‰åªæœ‰è¯¥ä¿¡å· MCU æ”¯æŒ) ä¹Ÿæä¾›äº† JPEG çš„ç¡¬ä»¶ç¼–ç å’Œè§£ç ï¼š </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32p4/api-reference/peripherals/jpeg.html"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://docs.espressif.com/projects/esp-idf/en/latest/esp32p4/api-reference/peripherals/jpeg.html</mark></a></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/c13da3b9d6544fc3b0bd8075acc30dbf" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/espressif/esp-idf/blob/master/examples/peripherals/jpeg/jpeg_decode/README.md"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ç¡¬ä»¶ jpeg decode</mark></a></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> ï¼ˆ*.jpg -&gt; *.rgbï¼Œå¦‚ RGB888, RGB565ï¼‰</mark></span></span></li><li id="https://www.notion.so/ca602ec4e07f40d49641de7b466aea08" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/espressif/esp-idf/blob/master/examples/peripherals/jpeg/jpeg_encode/README.md"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ç¡¬ä»¶ jpeg encode</mark></a></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> (*.rgb -&gt; *.jpg)</mark></span></span></li></ol><div id="https://www.notion.so/320a8b1ced9d43918522cce07badb380" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">å¯¹åº”çš„ ESP32 JPEG ç¡¬ä»¶ codec engine driverï¼š </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/espressif/esp-idf/tree/master/components/esp_driver_jpeg"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://github.com/espressif/esp-idf/tree/master/components/esp_driver_jpeg</mark></a></span></span></p></div><div id="https://www.notion.so/1c543661ab8549d8a89708207d5edb6f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">å…¶ä»– jpeg encodeï¼š</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/76524fc62c214cfcb5184afc79999b8d" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/bitbank2/JPEGENC"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://github.com/bitbank2/JPEGENC</mark></a></span></span></li><li id="https://www.notion.so/a2719d8860f947029b5a9f8b91b2dce7" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/tobozo/ESP32-Raytracer/tree/master"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://github.com/tobozo/ESP32-Raytracer/tree/master</mark></a></span></span></li><li id="https://www.notion.so/2c5228fd8fc14a0bbfc784b4cdfb8d70" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/espressif/esp-adf-libs/blob/master/esp_codec/include/codec/esp_jpeg_enc.h"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://github.com/espressif/esp-adf-libs/blob/master/esp_codec/include/codec/esp_jpeg_enc.h</mark></a></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/97e60dcdc5dd444884408fad74f18a34" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">æ²¡æœ‰æä¾› C æºä»£ç ï¼Œåªæä¾›äº†å¤´æ–‡ä»¶å’Œ lib åº“ï¼›</mark></span></span></li></ul></li></ol><h2 id="https://www.notion.so/4d1a7049c45d4886bacc0e0d7d6564fb" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/4d1a7049c45d4886bacc0e0d7d6564fb"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">5 æ˜¾ç¤º gif å›¾ç‰‡ </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://blog.opsnull.com/rust-embedded/rust-esp32-lcd-picture/#%E6%98%BE%E7%A4%BA-gif-%E5%9B%BE%E7%89%87"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></a></span></span></h2><div id="https://www.notion.so/7128669aaa554c79bc9a46b75ac2a311" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ä½¿ç”¨ Rust tinygif åº“å’Œç³»ç»Ÿå®šæ—¶å™¨æ¥æ˜¾ç¤º GIF å›¾ç‰‡ï¼š</mark></span></span></p></div><div id="https://www.notion.so/aa8b7b0d3be54d66bf4218c377cd8d9c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/3edef6211c234167b3225466c62c4597" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>// https://github.com/MabezDev/mkey/blob/main/firmware/src/main.rs
let image =
        tinygif::Gif::&lt;Rgb565&gt;::from_slice(include_bytes!(&quot;../Ferris-240x240.gif&quot;)).unwrap();
    let mut start = SystemTimer::now();
    let mut frames = 0;
    loop {
        for frame in image.frames() {
            let frame = Image::with_center(
                &amp;frame,
                Point::new(WIDTH as i32 / 2, (HEIGHT as i32 / 2) - 40),
            );
            frame.draw(pixels).unwrap();

            // TE_READY won&#x27;t get set until we mark that we&#x27;re ready to flush a buffer
            critical_section::with(|cs| {
                TE_READY.store(false, Ordering::SeqCst);
                TE.borrow_ref_mut(cs).as_mut().unwrap().clear_interrupt();
            });
            // wait for next sync
            while !TE_READY.load(Ordering::SeqCst) {}

            let pixels = unsafe {
                core::slice::from_raw_parts(
                    pixels.data().as_ptr() as *const u8,
                    pixels.data().len(),
                )
            };
            let now = SystemTimer::now();
            lcd_fill(&amp;mut spi, pixels);
            log::trace!(
                &quot;Time to fill display: {}ms&quot;,
                (SystemTimer::now() - now) / (SystemTimer::TICKS_PER_SECOND / 1024)
	           );
            frames += 1;
            let now = SystemTimer::now();
            if now.wrapping_sub(start) &gt; SystemTimer::TICKS_PER_SECOND {
                start = now;
                log::info!(&quot;FPS: {}&quot;, frames);
                frames = 0;
            }
        }
    }</span></span></span></code></pre><h2 id="https://www.notion.so/308700da230e4d8b8bb72c7bce029e16" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/308700da230e4d8b8bb72c7bce029e16"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">6 ä½¿ç”¨ LVGL æ˜¾ç¤ºå›¾ç‰‡ </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://blog.opsnull.com/rust-embedded/rust-esp32-lcd-picture/#%E4%BD%BF%E7%94%A8-lvgl-%E6%98%BE%E7%A4%BA%E5%9B%BE%E7%89%87"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></a></span></span></h2><div id="https://www.notion.so/49794429c0df4374bee9613a2e340d72" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://docs.lvgl.io/8.2/widgets/core/img.html"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://docs.lvgl.io/8.2/widgets/core/img.html</mark></a></span></span></p></div><div id="https://www.notion.so/9dfacec494dc45e7a0e3f73fa28df6ae" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">Images are the basic object to display images from flash (as arrays) or from files. Images can display symbols (LV_SYMBOL_â€¦) too.</mark></span></span></p></div><div id="https://www.notion.so/49b081062bdb4e0aa4fca38ced25c352" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">Using the Image decoder interface custom image formats can be supported as well.</mark></span></span></p></div><div id="https://www.notion.so/84611a920a9b4e39af9f68eec588bfac" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">Image sourceï¼šTo provide maximum flexibility, the source of the image can be:</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/4e2a9185e85644699b33829be7ab563f" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">a variable in code (a C array with the pixels).</mark></span></span></li><li id="https://www.notion.so/be81f9d056864af6911f4af2c5b19235" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">a file stored externally (e.g. on an SD card).</mark></span></span></li><li id="https://www.notion.so/9c875222f2cb42f5a6941cbc2ac414c4" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">a text with Symbols.</mark></span></span></li></ol><div id="https://www.notion.so/48a6fef9c786488ca7048f05f85f5444" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">To set the source of an image, use </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">lv_img_set_src(img, src).</code></mark></span></span></p></div><div id="https://www.notion.so/8b761e69826e4ac3bd654be7f984c6c8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">To generate a pixel array from a PNG, JPG or BMP image, use the Online image converter tool and set the converted image with its pointer: </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">lv_img_set_src(img1, &amp;converted_img_var)</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">; To make the variable visible in the C file, you need to declare it with LV_IMG_DECLARE(converted_img_var).</mark></span></span></p></div><div id="https://www.notion.so/73d4f94cda2e4a578c0aba7a68d571ec" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">To use external files, you also need to convert the image files using the online converter tool but now you should select the binary output format. You also need to use LVGLâ€™s file system module and register a driver with some functions for the basic file operation. Go to the File system to learn more. To set an image sourced from a file, use lv_img_set_src(img, â€œS:folder1/my_img.binâ€).</mark></span></span></p></div><div id="https://www.notion.so/b0ecce131edd4154a7c8f3f1d81506ba" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">You can also set a symbol similarly to Labels. In this case, the image will be rendered as text according to the font specified in the style. It enables to use of light-weight monochrome â€œlettersâ€ instead of real images. You can set symbol like lv_img_set_src(img1, LV_SYMBOL_OK).</mark></span></span></p></div><h2 id="https://www.notion.so/51c0ccbe1f184734b2e3cbe3d9995465" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/51c0ccbe1f184734b2e3cbe3d9995465"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">7 ä½¿ç”¨ embeded-graphics æ˜¾ç¤ºå›¾ç‰‡ </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://blog.opsnull.com/rust-embedded/rust-esp32-lcd-picture/#%E4%BD%BF%E7%94%A8-embeded-graphics-%E6%98%BE%E7%A4%BA%E5%9B%BE%E7%89%87"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></a></span></span></h2><h2 id="https://www.notion.so/d8feca751ba040b6874eb94f6a98b0ba" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/d8feca751ba040b6874eb94f6a98b0ba"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">8 ä½¿ç”¨ slint æ˜¾ç¤ºå›¾ç‰‡ </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://blog.opsnull.com/rust-embedded/rust-esp32-lcd-picture/#%E4%BD%BF%E7%94%A8-slint-%E6%98%BE%E7%A4%BA%E5%9B%BE%E7%89%87"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></a></span></span></h2><div id="https://www.notion.so/f8922113c3c443e1aba27a2f48cd2a13" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">ä½¿ç”¨ image crate å¯ä»¥å°†å„ç§ç…§ç‰‡è½¬æ¢ç§° RGBA8 æ ¼å¼:</mark></span></span></p></div><div id="https://www.notion.so/86a247cda69e4d499290da6a427075e5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/1cf9a15d19ae4bddbd26a4fe2ec5bd0d" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>let mut cat_image = image::open(&quot;cat.png&quot;).expect(&quot;Error loading cat image&quot;).into_rgba8();</span></span></span></code></pre><div id="https://www.notion.so/60a92edb55a14acebd8ca8da095e33d4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">Integration with OpenCV #2480: </mark></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/slint-ui/slint/discussions/2480"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://github.com/slint-ui/slint/discussions/2480</mark></a></span></span></p></div><div id="https://www.notion.so/a291a607dda7479f97a799a4112610a3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">You would basically need to convert the pixel into </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">SharedPixelBuffer</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> and use the </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slint::Image</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> constructor to convert it to an image. Then you can use </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">a property</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> to pass that image to the slint view.</mark></span></span></p></div><div id="https://www.notion.so/1742e03f61ff4f0cb82853c8664aae26" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/3aa0597ea98d4f859ca88cbd5f132271" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>export component View {
   in property &lt;image&gt; img &lt;=&gt; i.source;
   i := Image { }
}</span></span></span></code></pre><div id="https://www.notion.so/77e53a12d2914379a08d24bf4de30883" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">å‚è€ƒ:</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/1108bec5cc554339a52bf4f6fdcbf6ca" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/opsnull/rust-slint-opencv"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://github.com/opsnull/rust-slint-opencv</mark></a></span></span></li><li id="https://www.notion.so/e8bb5767718140c3bca1c158c5f4a1f6" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://releases.slint.dev/1.5.1/docs/rust/slint/struct.image"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">https://releases.slint.dev/1.5.1/docs/rust/slint/struct.image</mark></a></span></span></li></ol><div id="https://www.notion.so/030bcb2818124e28b936b656af3a4a0d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">LCD æ’­æ”¾è§†é¢‘æ˜¯é€šè¿‡è¿ç»­æ’­æ”¾é™æ€å›¾ç‰‡æ¥å®ç°çš„ï¼Œæ¯å¼ å›¾ç‰‡ä¸ºä¸€ä¸ª frameï¼Œæ’­æ”¾å›¾ç‰‡çš„é€Ÿç‡ä¸º FPSã€‚</mark></span></span></p></div><div id="https://www.notion.so/81ede548f6244ca0abe7e311bbd667d2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">å½±å“ LCD FPS å¿«æ…¢çš„å› ç´ ï¼š</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/861a421ca89d47cabaa6e1e803429d5e" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">renderingï¼šå¤„ç†å™¨ç”Ÿæˆä¸€å¸§æ•°æ® image æ•°æ®çš„è¿‡ç¨‹ï¼›</mark></span></span></li><li id="https://www.notion.so/fa615d7987944ecc9450b7c4569e31e8" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">transmissionï¼šå¤„ç†å…¶é€šè¿‡ç‰©ç†æ¥å£å‘é€ç»™ LCD çš„é€Ÿç‡ï¼Œç§°ä¸º interface frame rateï¼›</mark></span></span></li><li id="https://www.notion.so/7e8d545cbd2e492cb1f2d9fef0de7a01" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">displayï¼šLCD æ˜¾ç¤ºä¸€å¸§å›¾ç‰‡çš„é€Ÿç‡ï¼Œç§°ä¸º screen refresh rateï¼›</mark></span></span></li></ol><div id="https://www.notion.so/faa182c7a5274dfeafe4dd87cc0ed491" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">interface å’Œ screen refresh rate çš„å…³ç³»ï¼š</mark></span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/440fbefc7b3d4cbeb985f60fc46d3f23" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">For LCDs with SPI/I80 interfaces, the screen refresh rate is determined by the </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">LCD driver IC</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> and can typically be set by sending specific commands, such as the ST7789 command FRCTRL2 (C6h).</mark></span></span></li><li id="https://www.notion.so/2c6e0320263b4ede97d09fcd4f038703" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">For LCDs with RGB interfaces, the screen refresh rate is determined by </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">the main controller</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> and is </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"><code class="SemanticString__Fragment SemanticString__Fragment--Code">equivalent to</code></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault"> the interface frame rate.</mark></span></span></li></ol><div id="https://www.notion.so/535bbfd19b314242a0fadacdcf8d3055" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">RGB æ¥å£æ˜¯å¾®æ§åˆ¶å™¨ driver æ§åˆ¶çš„æ•°æ®å‘é€&amp;ä¼ è¾“ï¼›</mark></span></span></p></div><div id="https://www.notion.so/01843279a6af4c19ba9cadeab7c88058" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><ul id="https://www.notion.so/6e61916c4e344952bce51d2dacfc723b" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/100fc3f52a8880b5a5b5ddf8ee249d7f"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">Rust é©±åŠ¨ LCD - æ˜¾ç¤ºå›¾ç‰‡</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/d9cac5a6d0e241149f1e33770327fd8e"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">1 æ˜¾ç¤º raw å›¾ç‰‡ </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ece6f8c0a4d94e05841d327cbf2efb2f"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">2 æ˜¾ç¤º png å›¾ç‰‡ </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/0fa7bfd08b3a41abad808109e5bb9a77"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">3 æ˜¾ç¤º bmp å›¾ç‰‡ </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/0e91b468062f48f5ae7f36271c7332a3"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">4 æ˜¾ç¤º jpeg å›¾ç‰‡ </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/4d1a7049c45d4886bacc0e0d7d6564fb"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">5 æ˜¾ç¤º gif å›¾ç‰‡ </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/308700da230e4d8b8bb72c7bce029e16"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">6 ä½¿ç”¨ LVGL æ˜¾ç¤ºå›¾ç‰‡ </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/51c0ccbe1f184734b2e3cbe3d9995465"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">7 ä½¿ç”¨ embeded-graphics æ˜¾ç¤ºå›¾ç‰‡ </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/d8feca751ba040b6874eb94f6a98b0ba"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">8 ä½¿ç”¨ slint æ˜¾ç¤ºå›¾ç‰‡ </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorDefault">#</mark></span></span></div></a></li></ul></article>
    <aside class="UDAside">
        <a href="#content-html"><div id="up">â¬†ï¸</div></a>
        <a href="#message-board"><div id="down">â¬‡ï¸</div></a>
    </aside>
    <div id="message-board"></div>
    <aside class ="utterances">
      <script src="https://utteranc.es/client.js"
      repo="syx-413/syx-413.github.io"
      issue-term="pathname"
      theme="boxy-light"
      crossorigin="anonymous"
      async>
  </script>
  </aside>
  <footer class="Footer">
  <div>
    &copy; 413â€™s Website 2020~2025
  </div>
  <div>
    &centerdot;
  </div>
  <div>
    Powered by
    <a href="https://github.com/syx-413" target="_blank" rel="noopener noreferrer"> notablog</a>.
  </div>
</footer>
</body>

</html>